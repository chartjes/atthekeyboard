<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <link href="https://vjs.zencdn.net/5.5.3/video-js.css" rel="stylesheet">
        <script src="https://vjs.zencdn.net/ie8/1.1.1/videojs-ie8.min.js"></script>
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/about">About</a></li>
                                <li><a href="/atom.xml">RSS/Atom</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2><a href="/atthekeyboard/2012/05/09/grumpy-programmers-like-pair-programming/">Grumpy Programmers Like Pair Programming</a></h2>
           <h3>May 9th, 2012</h3>
        </header>
        <div>
            <p>Some of you might have a vision of me, the self-described and oft-labeled
Grumpy Programmer as the type who prefers to work in solitude. Uninterrupted,
I crank out code while in The Zone.</p>

<p>I prefer working in collaborative environments where the entire team gets to
work on the entire application. None of this siloing bullshit that I see happen
time and time again. "Borat is the only guy who understand our reporting system.
We can't possibly let anyone else work on it!" That sort of nonsense doesn't
belong on any team and also speaks of ridonkulous communication problems.</p>

<p>At <a href="http://www.kaplanprofessional.com">Kaplan Professional</a> they've chosen to
use <a href="http://en.wikipedia.org/wiki/Pair_programming">pair programming</a> as a normal,
everyday development practice. Our team consists of 3 developers in the main
offices in La Crosse, 7 remote workers spread across 3 time zones, 2 QA staff, 
one testing engineer, and our development manager. Pair programming has worked
out awesomely and I want to try and explain why.</p>

<p>One of the biggest hurdles facing a team with in-house and remote workers is
communication issues. Your classic pair programming setup is two developers
sitting together at the same desk, one typing while the other helps out with
suggestions on how to write the tests we're going to need and how to hand-crafted
our artisanal code. Sadly we still have people writing the tests AFTER they've
written the code, but grumpiness is not eliminated in one day.</p>

<p>At Kaplan we use the dynamic duo of <a href="http://join.me">Join.me</a> and <a href="http://www.teamspeak.com/">TeamSpeak</a>
for pair programming. Whomever is driving will start a join.me session, share the
link with their partner and away they go. There is much coding and playful banter
as Shit Gets Done. I cannot put it any other way.</p>

<p>Your partner keeps you honest and focussed on the task you're trying to solve. For
example, when I was coding a feature I was not 100% familiar with I was able to 
get my pair to do research on other parts of the code base while I was creating
the skeletons for some tests. Many times my pair would suggest "don't you think we
could make that bit of code better by...", and more often than not we'd have a good
discussion about writing easy-to-understand-yet-efficient code or discuss how what
we are doing is out of character with the rest of the code. <a href="http://www.slideshare.net/rdohms/bettercode-phpbenelux212alternate">Object calisthenics</a>
is a favourite topic of mine and has led some of my other fellow developers to rethink
how they have been building things.</p>

<p>See, people have this idea that pair programming means that one guy codes while the
other sullenly watches or surfs the internet instead. Or it means two developers
fucking around instead of working. I cannot speak for other developers, but I don't
put up with that shit while paired. I am expecting my pair to devote as much attention
to the task at hand as I am, and I return the favour by being attentive and helpful
towards my pair when I am not driving the session.</p>

<p>Because developers are taking turns solving problems and implementing solutions,
the amount of tribal knowledge (knowledge about the application itself locked up 
in people's brains instead of shared and/or documented) decreases and everyone's
understanding of the system goes up. This transfer of knowledge can only really
happen as one developer shows another just what the hell is going on inside this
application. There is no better way I can think of to do this than while paired.</p>

<p>Pair programming also has the added good side effect of allowing team members to
get to know each other. It's only the most anti-social of co-workers who won't end
up discussing things outside of work while pair programming. I don't see any reason
to work with robots who only care about how many story points we are cranking out
every sprint. We are people first and coders second. Don't forget that.</p>

<p>Finally, pair programming results in more than one person understanding how a 
particular problem was solved and how the solution was implemented. At Kaplan
we always have a sprint demo day at the end where we demonstrate the various
features that were implemented during the sprint. With everyone having used
pair programming, it's much easier for the group as a whole to decide who will
demonstrate what. No need for one developer to hog all the glory!</p>

<p>This also ends up being a great way for those who already understand the
application to teach new hires how things work. Kaplan Professional had 
expanded its team quite rapidly when I started and I think that without pairing we would
still be struggling to meet our sprint commitments. Nothing prompts rage-quitting
more than a situation where it is incredibly difficult for new hires to make
positive contributions to the team within a few days of starting.</p>

<p>I understand that not every organization is ready to make a commitment to use
pair programming. Just like not every organization is ready to make a commitment
to writing tests as part of their normal flow. But don't harbour any misconceptions
about what pair programming <em>really</em> is: two developers working together towards
solving problems, alternating who is mashing keys on a keyboard. Both developers
<em>are</em> working, they are just working <em>together</em>.</p>

<p>The goal is to solve problems within a unit of time that you have committed to. 
Kaplan Professional is no different in that it expects you to honour your commitments.
Pair programming has been a way for problems to get solved faster than if 
individual programmers had been trying to solve them. Communication is up, non-working
features are done, and the amount of work actually getting done has increased
noticeably in the two months since I started working in pairs.</p>

<p>I cannot recommend enough giving pair programming an honest try in your work
environment. You might be surprised to find out that you are Getting More Shit Done
than you realize.</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/atthekeyboard/2012/04/15/build-php-54-on-centos-with-vagrant/">Build PHP 5.4 on CentOS with Vagrant</a></h2>
           <h3>April 15th, 2012</h3>
        </header>
        <div>
            <p>I like the idea of using <a href="http://vagrantup.com">Vagrant</a> to create virtual
machines for my development work. Doing things this way I think keeps the
host machine cleaner and allows you the ability to distribute those VM's
to other people as well.</p>

<p>My old boss Ben Ramsey did a very informative post on <a href="http://benramsey.com/blog/2012/03/build-php-54-on-centos-62/">getting PHP 5.4 configured on CentOS</a>
so I decided to one-up him by taking his instructions and creating a <a href="http://puppetlabs.com/">Puppet</a>
manifest so you could do this using Vagrant or on any server that you can 
provision using Puppet.</p>

<p>First, you will need a CentOS base box to play with. I used <a href="http://www.vagrantbox.es/37/">this box</a>
but I think any CentOS 6.0 (or above) base box will do. If you are feeling really
adventurous you could grab an ISO and use <a href="https://github.com/jedi4ever/veewee">Vewee</a> 
and follow <a href="http://www.ducea.com/2011/08/15/building-vagrant-boxes-with-veewee/">these instructions</a>
to create your own.</p>

<p>Whatever box you choose, the next step is to create the directory where your VM
will run and run 'vagrant init' with the name of the box and then edit the Vagrantfile.
Here's a condensed version of my Vagrantfile</p>

<pre><code>Vagrant::Config.run do |config|
  config.vm.box = "centos-60-x86_64"

  config.vm.forward_port 80, 8080
  config.vm.forward_port 8000, 8000

  config.vm.provision :puppet do |puppet|
     puppet.manifests_path = "manifests"
     puppet.manifest_file  = "default.pp"
  end
end
</code></pre>

<p>Those port forwards are identical to the ones that Ben suggested using. You
can get rid of the one that maps port 8000 if you don't feel like playing
around with the new built-in web server introducted in PHP 5.4.</p>

<p>Now, create the manifests directory inside the directory where you are placing
the new VM and add a file called default.pp that looks like this:</p>

<pre><code># Puppet manifest for my PHP dev machine

class httpd {
  exec { 'yum-update':
    command =&gt; '/usr/bin/yum -y update'
  }

  package { "httpd":
    ensure =&gt; present,
  }

  package { "httpd-devel":
    ensure  =&gt; present,
  }
}

class phpdev {
  package { "libxml2-devel":
    ensure  =&gt; present,
  }


  package { "libXpm-devel":
    ensure  =&gt; present,
  }

  package { "gmp-devel":
    ensure  =&gt; present,
  }

  package { "libicu-devel":
    ensure  =&gt; present,
  }

  package { "t1lib-devel":
    ensure  =&gt; present,
  }

  package { "aspell-devel":
    ensure  =&gt; present,
  }

  package { "openssl-devel":
    ensure  =&gt; present,
  }

  package { "bzip2-devel":
    ensure  =&gt; present,
  }

  package { "libcurl-devel":
    ensure  =&gt; present,
  }

  package { "libjpeg-devel":
    ensure  =&gt; present,
  }

  package { "libvpx-devel":
    ensure  =&gt; present,
  }

  package { "libpng-devel":
    ensure  =&gt; present,
  }

  package { "freetype-devel":
    ensure  =&gt; present,
  }

  package { "readline-devel":
    ensure  =&gt; present,
  }

  package { "libtidy-devel":
    ensure  =&gt; present,
  }

  package { "libxslt-devel":
    ensure  =&gt; present,
  }
}

class rpmforge {
  exec {
    "/usr/bin/wget http://packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm":
      alias   =&gt; "grab-rpmforge",
  }

  exec {
    "/bin/rpm --import http://apt.sw.be/RPM-GPG-KEY.dag.txt":
      alias   =&gt; "import-key",
      require =&gt; Exec["grab-rpmforge"],
  }

  exec {
    "/bin/rpm -i rpmforge-release-0.5.2-2.el6.rf.*.rpm":
      alias   =&gt; "install-rpmforge",
      require =&gt; Exec["import-key"],
  }

  package { "libmcrypt-devel":
    ensure  =&gt; present,
    require =&gt; Exec["install-rpmforge"]
  }
}

include httpd
include phpdev
include rpmforge

</code></pre>

<p>Now, there <em>appears</em> to be a lot of stuff going on in there, but it's actually
quite simple. I broke things down into 3 distinct groups.</p>

<p>The first group (
which I called 'httpd') makes sure that we install Apache 2 and the development
libraries and header files that will be needed to compile PHP. Then we open up
the firewall to allow access to the VM on those two ports. By default Vagrant
maps port 22 on the VM to port 2222 on the VM, so no need to add that in.</p>

<p>The next group (phpdev) is installing all the support libraries that Ben recommended 
in his own article.</p>

<p>Finally we need to execute a few commands to allows us to also install libmcrypt-devel
because it is not part of the standard CentOS distribution, but is available via
RPMForge.</p>

<p>Save that file (make sure there are no typos either from me or from you!), then type
'vagrant up' and it will try and it will try to provision your new server with this
Puppet manifest and add in all your files.</p>

<p>Then you can follow the rest of Ben's instructions on how to compile PHP 5.4 (I
installed PHP 5.4.1RC1 just to be living on the edge) and don't forget to verify
that your Apache setup is configured to all you to serve up PHP files.</p>

<p>I think that you can have a cutting-edge CentOS VM with the latest PHP installed on
it up and running in under an hour from starting to download your CentOS Vagrant
base box to verifying your test file with phpinfo() in it worked.</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/atthekeyboard/2012/04/05/metatesting-testing-constructors/">Metatesting: Testing Constructors</a></h2>
           <h3>April 5th, 2012</h3>
        </header>
        <div>
            <p>If you have a PHP application that makes heavy use of objects (which is probably
95% of you reading this) then you will have objects with constructor methods
in them. It is also very likely that there is some stuff going on in those
constructors. So how do you test things like this?</p>

<p>Here is the constructor method that we are trying to test:</p>

<pre><code>&lt;?php

class Alpha
{
    protected $_foo;
    protected $_bar;
    protected $_baz;

    public function __construct()
    {
        $container = Grumpy_Container::getInstance();
        $alphaConfig = $container-&gt;alphaConfig();
        $this-&gt;_foo = $alphaConfig-&gt;foo;
        $this-&gt;_bar = $alphaConfig-&gt;bar;
        $this-&gt;_baz = $alphaConfig-&gt;baz;
    }

    // the rest of our class is here
}
</code></pre>

<p>In this example, Grumpy&#95;Container is an object that is available via
autoloading and it is used as a dependency injection container (DIC).</p>

<p>Okay, so how do we test that the constructor is doing what it is supposed to?
We would want to verify that those protected class attributes have been set
to values we are expecting.</p>

<p>In order to do that we will also need to override the values in our DIC so 
when we run the test we have values in there we are expecting.</p>

<pre><code>&lt;?php

public testConstructorAssignsExpectedAttributeValues()
{
    $container = Grumpy_Container::getInstance();

    // Create our mock configuration object
    $alphaConfig = new stdClass();
    $alphaConfig-&gt;foo = 'testfoo';
    $alphaConfig-&gt;bar = 'testbar';
    $alphaConfig-&gt;baz = 'testbaz';

    // Place this back in the container to override what we have
    $container-&gt;alphaConfig = function() use ($alphaConfig) {
        return $alphaConfig;
    };

    // Create our mock object
    $alphaTest = $this-&gt;getMockBuilder('Alpha')
        -&gt;disableOriginalConstructor()
        -&gt;getMock();

    // Manually run the constructor
    $alphaTest-&gt;__construct();

    // Check for values we expect
    $this-&gt;assertAttributeEquals(
        $alphaConfig-&gt;foo,
        '_foo',
        $alphaTest,
        'Should set expected foo config value'
    );

    $this-&gt;assertAttributeEquals(
        $alphaConfig-&gt;bar,
        '_bar',
        $alphaTest,
        'Should set expected foo config value'
    );

    $this-&gt;assertAttributeEquals(
        $alphaConfig-&gt;baz,
        '_baz',
        $alphaTest,
        'Should set expected bar config value'
    );

}

</code></pre>

<p>The magic method here is assertAttributeEquals(). It lets you check the value
inside any protected or private class attributes, which is absolutely a 
requirement in this example. It is probably better to have some other
publicly-available methods that can return us the protected (or in some
cases private because you don't want anyone to manipulate them) attributes.</p>

<p>Hope this helps you understand some ways to test your constructors.</p>

        </div>
            </article>
    <nav>
        <a href="/page/23">Newer Posts</a><br />
        <a href="/page/25">Older Posts</a><br />
    </nav>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <section>
                            <h3>Find stuff</h3>
                            <script>
                              (function() {
                                var cx = '010269902375244482518:ddxhg1qhod4';
                                var gcse = document.createElement('script');
                                gcse.type = 'text/javascript';
                                gcse.async = true;
                                gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                                    '//www.google.com/cse/cse.js?cx=' + cx;
                                var s = document.getElementsByTagName('script')[0];
                                s.parentNode.insertBefore(gcse, s);
                              })();
                            </script>
                            <gcse:searchbox-only></gcse:searchbox-only>
                        </section>
                        <section>
                            <h3>Contact me</h3>
                            <ul>
                                <li>Email me at chartjes@grumpy-learning.com</li>
                                <li>Find me on Twitter as <a href="https://twitter.com/grmpyprogrammer">@grmpyprogrammer</a></li>
                            </ul>
                        </section>
			<section>
				<h3>Sponsor me</h3>
				<p>If you like the work I do on <a href="https://github.com/opencfp/opencfp/">OpenCFP</a> you can become a
				sponsor via my <a href="https://github.com/sponsors/chartjes">GitHub sponsors</a> page. Your sponsorship
				allows me to spend more time on open source and less time writing books and training material.</p>
			</section>
                        <section>
                            <h3>Books</h3>
                            <ul>
				<li><a href="https://leanpub.com/grumpy-guide">The Grumpy Programmer's Guide To Testing PHP Applications (currently pre-ordering)</a></li>
                                <li><a href="https://leanpub.com/test-driven">Building Test-Driven Developers</a></li>
                                <li><a href="https://leanpub.com/minimumviabletests">Minimum Viable Tests</a></li>
                                <li><a href="https://leanpub.com/grumpy-phpunit">The Grumpy Programmer's PHPUnit Cookbook</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2020 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
