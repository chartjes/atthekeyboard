<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <link href="https://vjs.zencdn.net/5.5.3/video-js.css" rel="stylesheet">
        <script src="https://vjs.zencdn.net/ie8/1.1.1/videojs-ie8.min.js"></script>
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/about">About</a></li>
                                <li><a href="/atom.xml">RSS/Atom</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2><a href="/2008/03/06/my-framework-is-more-mvc-than-your-framework/">My framework is more MVC than *your* framework!</a></h2>
           <h3>March 6th, 2008</h3>
        </header>
        <div>
            <p>
I like to check out the <a href="http://reddit.com/r/programming">programming section on Reddit</a> on a regular basis because it usually contains some interesting links.  Yesterday I came across a link that discussed the fallout surround a presentation at phplondon08 where <a href="http://pookey.co.uk/blog/index.php?url=archives/43-phplondon08-the-crazy-guy-mail.html">panelists on a discussion of frameworks got heckled</a> but some guy claiming to be an expert on what a real MVC framework is.</p>

<blockquote>
All major Rails clone PHP frameworks that exist on the market today are a complete and utter failure. All of them call themselves MVC frameworks and none of them implement actual MVC. In fact, some of the worst ones merely resemble MVC, and have no right whatsoever to be called frameworks. Whatever benefits of sexy ORMs and flexible build systems and scaffolding and other secondary tools these frameworks have are nullified by the fact that using them results in architectural chaos which is no better than your usual spaghetti code. This is because the people who wrote Rails didn't bother to understand MVC, and the PHP amateurs who were excited about the idea of getting done more in less time blindly tried to clone Rails into PHP and in so doing not only replicated the stupidity of Rails into PHP but also multiplied it by their own incompetence and PHP's shortcomings as a language and a platform.
</blockquote>

<p>
No, tell us how you really feel about it.
</p>

<p>
Anyhow, this guy apparently works for the <a href="http://agavi.org">Agavi</a> project, a (wait for it) MVC framework written in PHP as an "evangelist".  Well, he certainly talks like you would expect an evangelist too.
</p>

<p>
The comments for that post are really interesting too, as people take their usual swipes at PHP, and CakePHP, and the Symfony guys come out in droves to talk up Symfony, and on and on it goes.  Sadly, this is not a unique occurance on the web.
</p>

<p>
So, back to the topic of the post.  Is this guy right?  Is *nobody* except Agavi doing it right on the PHP side of things?  I took a peek at their documentation.  Lots of statements about what a framework should and shouldn't do.  
</p>

<p>
<em>(Author's note 03/10/08: removed code example as, well, it's not really relevant to the discussion, other than making me giggle about mixing business logic with presentation logic)</em>
</p>

<p>
Digging through the documentation some more, it's quite dry.  Short and sweet, not a lot of tips on building an Agavi app from scratch.  Again, to be fair, that might not be the point of the documentation.  But it's approach is very, *very* different from the "Rails way" that CakePHP has been following.  Before you flame, there is nothing wrong with the "Rails way" because, if nothing else, it has forced developers to crank their skills up a notch and actually *think* about what they are building.
</p>

<p>
I knew one of the original developers of <a href="http://www.mojavi.org">Mojavi</a> (of which Agavi is a fork) and he was a really smart guy (Hi Shawn!). My early forays into framework use was with Mojavi, when trying to convince a previous employer that we needed to rewrite this monster PHP application with Mojavi so we could get things like a private branding version of the site done a lot easier.
</p>

<p>When I compare this to Cake, they are as different as night and day.  Agavi (and Mojavi) are heavily configuration-oriented (XML *everywhere* for config files), while Cake uses conventions to try and speed things up.  But the real truth is this:  they are both trying to separate your business logic and your presentation logic to make things easier for the poor saps who have to build these applications.
</p>

<p>
Our lovely heckler has missed the forest for the trees, as far as I'm concerned.  It's like complaining that you can't call it a forest because the trees aren't growing straight up and down, but tend to branch out in different directions.  They're still trees, right?
</p>

<p>Frameworks are designed to try and help you to get things done faster *and* to organize your code in a much more consistent manner.  Cake uses the <a href="http://en.wikipedia.org/wiki/Model-view-controller">Model-view-controller design pattern</a>, and I think that the quote below makes it clear that Cake is doing it the right way:
<blockquote>
Model-view-controller (MVC) is an architectural pattern, which at the same time is also a Multitier architecture, used in software engineering. In complex computer applications that present a large amount of data to the user, a developer often wishes to separate data (model) and user interface (view) concerns, so that changes to the user interface will not affect data handling, and that the data can be reorganized without changing the user interface. The model-view-controller solves this problem by decoupling data access and business logic from data presentation and user interaction, by introducing an intermediate component: the controller.
</blockquote>
If you are trying to tell me that CakePHP does not follow that practice, then I am calling you a fucking idiot who is more interested in pedantic minutiae than understanding that there is more than one way to implement MVC.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/2008/03/04/custom-cakephp-12-pagination-queries/">Custom CakePHP 1.2 Pagination Queries</a></h2>
           <h3>March 4th, 2008</h3>
        </header>
        <div>
            <p>
(Note: I will be cross-posting a version of this to <a href='http://book.cakephp.org'>the CakePHP Cookbook</a> within a day or two).
</p>

<p>
As amazing as the built-in CakePHP pagination helper is, sometimes you have to create your own custom queries for data you wish to paginate.  For <a href='http://www.ibl.org'>the simulation baseball league site</a> I wanted to be create an admin area where I could paginate through the series instead of individual games.  It took some digging around with google, but I found some info in a thread (thanks to <a href='http://www.3hndesigns.com/'>Baz</a> for contributing that tidbit to the thread) on how to do just that.
</p>

<p>
Okay, so it turns out that the paginate() method that is used to generate the data that you (oddly enough) paginate through takes the same arguments as Model::findAll().  So, if you want to use your own query, you simply create a 'paginate' method for your model.  In my case, I needed a query that would group things together (because a 'series' is simply a collection of all games between two teams in a particular week).  The query stuff I did is ugly because there currently is no support 'group by' in CakePHP (although that would be a very interesting project to tackle).  So, here's what I did:
</p>

<pre><code>/**
 * Custom paginate method
 */
function paginate($conditions, $fields, $order, $limit, $page = 1, $recursive = null) {
    $conditions[] ="1 = 1 GROUP BY week, away_team_id, home_team_id";
    $recursive = -1;
    $fields = array('week', 'away_team_id', 'home_team_id');

    $params = array(
          'conditions' =&gt; $conditions,
          'recursive' =&gt; $recursive,
          'fields' =&gt; $fields,
          'order' =&gt; $order,
          'limit' =&gt; $limit,
          'page' =&gt; $page
     );

     return $this-&gt;find('all', $params);
}
</code></pre>

<p>
So, that's the first part of the custom query stuff taken care off.  Next, I needed to be able to properly count the number of 'series' so that the numbers (you know, that stuff that says 'page 7 of 23') come out properly.  Again, you can override the paginateCount() method if you need to.  It uses the same parameters as Model::findCount().  Now, the custom query I'm using below is Postgres-specific, so YMMV:
</p>

<pre><code>/**
 * Custom paginateCount method
 */
function paginateCount($conditions = null, $recursive = 0) {
    $sql = "SELECT DISTINCT ON(week, home_team_id, away_team_id) week, home_team_id, away_team_id FROM games";
    $this-&gt;recursive = $recursive;
    $results = $this-&gt;query($sql);

    return count($results);
}
</code></pre>

<p>
So there you have it.  Hope this helps out anyone who's been trying to figure out how to use custom queries with their pagination.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/2008/02/27/whats-in-chris-brain-february-2008-edition/">What&#039;s In Chris&#039; Brain: February 2008 Edition</a></h2>
           <h3>February 27th, 2008</h3>
        </header>
        <div>
            <p>
I'm sitting in the Orlando airport at this ungodly hour waiting for a flight to Memphis as part of an Orlando -> Memphis -> Toronto trip back from my two days at the Newspaper Association of America conference.  I was there with my <a href='http://www.xmlteam.com'>employer</a> to help start promoting the <a href="http://www.sportso.com">project I've been working on</a>.  It was an interesting show, and I had a great time in the booth hanging out and talking with Ken Zajac from <a href="http://sportsnetwork.com">The Sports Network</a> and Digger Turnbull from <a href="http://fantasysports.ca">Fantasy Sports Services</a>.  It was fun huddling around Digger's computer listening to the latest moves during the NHL's trading deadline day.
</p>

<p>Anyway, enough geeking out about my sports fetish.  Work took up a lot of my time this last 2 weeks getting ready for the demo, so my posting has suffered a bit.  Here are some of the things I've been thinking about.:
<ul>
<li>more and more messages about using the CakePHP Auth component on the mailing list</li>
<li>I will be doing some Python work later this week on a utility to rip through some of our archived XML documents at work and do some search-and-replace ninja work.</li>
<li>Investing in using <a href="http://jquery.com">jQuery</a> for work has made for some super-quick integration of some new features.  It took me under half-an-hour from the first search in google to get an autocomplete plugin for jQuery working.  Now *that* is rapid development</li>
<li>Despite my best efforts I can't get vim setup and working the way I want.  Sorry Kevin, TextMate is just the best one for me, and Komodo when I need to break out the Xdebug guns</li>
<li>I'm going to put together a post (and contribute the same info to the <a href="http://book.cakephp.org">CakePHP Cookbook</a>) on my experiences with custom pagination usage with Cake, since I had to hack something together for recent changes I've been working on for the <a href="http://www.ibl.org">IBL website</a></li>
</ul>
</p>

<p>
Anyway, enough talking.  It's way too early to do this sort of nonsense (can't believe I have coherent thoughts at 5:30AM) and it's close to boarding time.  See you on the other side...
</p>

        </div>
            </article>
    <nav>
        <a href="/page/92">Newer Posts</a><br />
        <a href="/page/94">Older Posts</a><br />
    </nav>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <section>
                            <h3>Find stuff</h3>
                            <script>
                              (function() {
                                var cx = '010269902375244482518:ddxhg1qhod4';
                                var gcse = document.createElement('script');
                                gcse.type = 'text/javascript';
                                gcse.async = true;
                                gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                                    '//www.google.com/cse/cse.js?cx=' + cx;
                                var s = document.getElementsByTagName('script')[0];
                                s.parentNode.insertBefore(gcse, s);
                              })();
                            </script>
                            <gcse:searchbox-only></gcse:searchbox-only>
                        </section>
                        <section>
                            <h3>Contact me</h3>
                            <ul>
                                <li>Email me at chartjes@grumpy-learning.com</li>
                                <li>Find me on Twitter as <a href="https://twitter.com/grmpyprogrammer">@grmpyprogrammer</a></li>
                            </ul>
                        </section>
			<section>
				<h3>Sponsor me</h3>
				<p>If you like the work I do on <a href="https://github.com/opencfp/opencfp/">OpenCFP</a> you can become a
				sponsor via my <a href="https://github.com/sponsors/chartjes">GitHub sponsors</a> page. Your sponsorship
				allows me to spend more time on open source and less time writing books and training material.</p>
			</section>
                        <section>
                            <h3>Books</h3>
                            <ul>
				<li><a href="https://leanpub.com/grumpy-guide">The Grumpy Programmer's Guide To Testing PHP Applications (currently pre-ordering)</a></li>
                                <li><a href="https://leanpub.com/test-driven">Building Test-Driven Developers</a></li>
                                <li><a href="https://leanpub.com/minimumviabletests">Minimum Viable Tests</a></li>
                                <li><a href="https://leanpub.com/grumpy-phpunit">The Grumpy Programmer's PHPUnit Cookbook</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2020 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
