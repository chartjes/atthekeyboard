<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <link href="https://vjs.zencdn.net/5.5.3/video-js.css" rel="stylesheet">
        <script src="https://vjs.zencdn.net/ie8/1.1.1/videojs-ie8.min.js"></script>
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/about">About</a></li>
                                <li><a href="/atom.xml">RSS/Atom</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2><a href="/2009/11/10/code-generation-for-fun-and-profit/">Code Generation For Fun And Profit</a></h2>
           <h3>November 10th, 2009</h3>
        </header>
        <div>
            <p><i>(Note, I almost forgot to post about this today as part of my November blogging challenge)</i></p>

<p>
I have a serious programmer man-crush on <a href="http://gilesbowkett.blogspot.com/">Giles Bowkett</a>.  I don't always agree with him, but when he talks about programming he never fails to make me stop and think.  Just like <a href="http://slash7.com">Amy Hoy</a> when she talks about design.  In a blog post he mentioned what he considers <a href="http://www.amazon.com/Code-Generation-Action-Jack-Herrington/dp/1930110979/ref=sr_1_1?ie=UTF8&s=books&qid=1257909776&sr=8-1">the best book that programmers have never read</a>.  I've taken a look at the sample chapters that are available from the publisher.  I was very impressed.  Then I watched the talk that Giles gave about <a href="http://mtnwestrubyconf2008.confreaks.com/03bowkett.html">code generation and why you should be aware of it.</a>
</p>

<p>
I've probably had more experience with code generation than most programmers, being an early proponent and user of CakePHP's "bake" system (even writing my own test shell for it, which I'm sure was abandoned and not used by anyone else).  When I tell people about what you could do with 'bake', a lot of times I got blank stares.  They didn't understand why I was so excited by it.  That's okay, sometimes I get excited about things that other people could care less about.
</p>

<p>
But you read things like "to generate these 1050 files by hand would take 3 man-years on the project, and we could create a generator to do it in 2 man-months", well, if that doesn't pique your interest then I think you're in programming for the money, not for the challenge of solving problems.
</p>

<p>
Which is why I think I need to set aside some time at work to examine a tool that I hope I can lean heavily on for upcoming PHP projects, <a href="http://framework.zend.com/manual/en/zend.tool.framework.html">Zend_Tool_Framework</a>.  If I'm right, and Zend_Tool_Framework is nice and tight and generates code that was of as high quality as "bake" did, then it will help speed up development.
</p>

<p>
Rails leans very heavily on code generation to provide it with the structure that it has, which in  term allows you to get down to the job of solving the problem you are faced with, instead of creating code from scratch.  A well-written code generator can save you immense amounts of time.  I do not see much evidence of a culture of code generation in PHP, but the Rails people *get* it.  
</p>

<p>
So, do the following:
<ul>
<li>Watch Giles' presentation.  He is smart AND funny</li>
<li>Either buy "Code Generation In Action" or at least <a href="http://www.manning.com/herrington/">check out the sample chapters you can download</a></li>
<li>Buy me a copy of this book.  It's on my Amazon.com <a href="http://www.amazon.com/wishlist/2ZNT96VNHBEQ2/ref=reg_hu-wl_goto-registry?_encoding=UTF8&sort=date-added">wishlist!</a></li>
</ul>
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/2009/11/09/why-i-dont-want-to-use-tools-written-for-php-4/">Why I Don&#039;t Want To Use Tools Written For PHP 4</a></h2>
           <h3>November 9th, 2009</h3>
        </header>
        <div>
            <p>
I was engaged in a lively discussion on Twitter this morning sparked by someone grumbling that people should not be writing frameworks that target PHP 4.  In the course of that discussion, I offered my opinion on a couple of things:
<ul>
<li><a href="http://codeigniter.com">My least favourite framework</a> suffers from having code that detects whether or not you are using PHP 4</li>
<li>PHP 5 has been out long enough that pandering (I do not know if there is a better word for that) to the crowd that does not want to update to it is counter-productive.</li>
</ul>
</p>

<p>It was pointed out to me that CodeIgniter has 23 lines of code in it dedicated to detecting what version of PHP you are running.  In my opinion, that is 23 too many.  
</p>

<p>
Of course, it isn't as simple as that.  If you have customers who are paying you for your application and they are running PHP 4, well, you have a tough decision:  keep supporting them and your application becomes more and more convoluted as the language changes or be bold and tell them "from this point forward new versions of my application will be PHP 5 only."  I think the truth is that very few people are willing to make that sort of stand, and that's okay.  In the end, you really should use whatever tools you are comfortable with.  But it's important to understand why those tools are, in the big picture, substandard.
</p>

<p>
My personal opinion is that PHP 5 has enough new features that either replace existing functionality in PHP 4 or give you features that were not available before, only sheer apathy prevents you from creating a PHP 5-specific version of your application.  Not to mention that PHP 5 itself runs faster than PHP 4. If you have to turn on E_STRICT so your application stops spitting out errors all over the place, you are doing it wrong.
</p>

<p>
What I think would be very interesting is to see how <a href="http://www.rubyonrails.org">Ruby on Rails</a> and <a href="http://www.djangoproject.com">Django</a> handle this problem:  what sort of contortions do they go through when Ruby and Python (respectively) make changes and perhaps break backwards compatibility.  Is PHP the only programming language for the web where the people running older versions hold onto it kicking and screaming, despite gobs of evidence that newer stable versions of the language have fixed bugs, perform better, and offer new useful features?  Enquiring minds want to know!
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/2009/11/07/sending-data-via-http-put-using-basic-authentication/">Sending data via HTTP-PUT using Basic Authentication</a></h2>
           <h3>November 7th, 2009</h3>
        </header>
        <div>
            <p>(This is another problem I solved with the help of <a href="http://stackoverflow.com"</a>Stack Overflow</a> and some <a href="http://en.wikipedia.org/wiki/Rubber_duck_debugging">rubber duck debugging</a>)
</p>

<p>
While cleaning up some code I noticed a function that was sending data via an HTTP-PUT had stopped working.  A classic example of code "accidentally working".  So, this was the perfect opportunity to (a) write a test to verify that it worked and (b) clean up the code so that it was doing the job properly.  It had been using cURL, but I was using PHP streams elsewhere so I decided to be consistent.
</p>

<p>
So here's what we had to do:
<ul>
<li>Pass the code a URL of where the file was going to end up on the eXist DB server</li>
<li>Pass the name of the temporary file that contained the info</li>
<li>Send the file via HTTP-PUT to eXist, along with the username and password it requires.</li>
</ul>
</p>

<p>
The old code was sending the username and password as part of the URL, but that simply was not working any more.  Why it stopped working isn't all that important except to say that passing the username and password the *proper* way, which is via the HTTP header in the request, is the correct way to go.
</p>

<p>
So, I googled around, looked at my existing code (including an <a href="https://www.littlehart.net/atthekeyboard/2008/01/11/how-to-http-put-a-file-somewhere-using-php/">old blog post</a>) I tried a few things and just couldn't get it to work.  The problem?  I kept getting a "401 Authorization denied" message.  I was positive I was sending the header in the correct format.  So, I asked Stack Overflow to help me while I looked at the code with my trusty stuffed Grumpy Dwarf doll (you know, from the Disney Movie) in my lap looking at the screen while I went over the code.
</p>

<p>
You know, I never figured that "rubber duck debugging" worked, but in this instance by explaining what I'm doing I figured out a few things:
<ul>
<li>Don't blindly trust code examples you find on the internet</li>
<li>Sometimes taking the time to explain how something is supposed to work someone actually makes it easier for you to figure it out.</li>
</ul>
</p>

<p>
Lo and behold, I <a href="http://stackoverflow.com/questions/1691530/sending-a-file-via-http-put-in-php">figured it out</a>.  I'll repost the code here too:
<br />
~~~
$params = array(
    'http' => array(
        'method' => 'PUT',
        'header' => "Authorization: Basic " . base64_encode($this->ci->config->item('ws_login') . ':' . $this->ci->config->item('ws_passwd')) . "\r\nContent-type: text/xml\r\n",
        'content' => file_get_contents($tmpFile)
             )
         );
$ctx = stream_context_create($params);
$response = @file_get_contents($url, false, $ctx);

return ($response == '');
~~~
</p>

<p>
My mistake?  For some reason unbeknownst to me I was passing an array of values as the header.  Dunno why I did it, must've got it from an example somewhere.  Now I have code that successfully sends my file to eXist via HTTP-PUT.  The only thing I do not like is that I have to suppress the output of file_get_contents() because it throws a warning while also reporting the successful 201 HTTP response code.  Perhaps there is another way to do it, but I know with 100% certainty that this code does work.
</p>

        </div>
            </article>
    <nav>
        <a href="/page/55">Newer Posts</a><br />
        <a href="/page/57">Older Posts</a><br />
    </nav>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <section>
                            <h3>Find stuff</h3>
                            <script>
                              (function() {
                                var cx = '010269902375244482518:ddxhg1qhod4';
                                var gcse = document.createElement('script');
                                gcse.type = 'text/javascript';
                                gcse.async = true;
                                gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                                    '//www.google.com/cse/cse.js?cx=' + cx;
                                var s = document.getElementsByTagName('script')[0];
                                s.parentNode.insertBefore(gcse, s);
                              })();
                            </script>
                            <gcse:searchbox-only></gcse:searchbox-only>
                        </section>
                        <section>
                            <h3>Contact me</h3>
                            <ul>
                                <li>Email me at chartjes@grumpy-learning.com</li>
                                <li>Find me on Twitter as <a href="https://twitter.com/grmpyprogrammer">@grmpyprogrammer</a></li>
                            </ul>
                        </section>
			<section>
				<h3>Sponsor me</h3>
				<p>If you like the work I do on <a href="https://github.com/opencfp/opencfp/">OpenCFP</a> you can become a
				sponsor via my <a href="https://github.com/sponsors/chartjes">GitHub sponsors</a> page. Your sponsorship
				allows me to spend more time on open source and less time writing books and training material.</p>
			</section>
                        <section>
                            <h3>Books</h3>
                            <ul>
				<li><a href="https://leanpub.com/grumpy-guide">The Grumpy Programmer's Guide To Testing PHP Applications (currently pre-ordering)</a></li>
                                <li><a href="https://leanpub.com/test-driven">Building Test-Driven Developers</a></li>
                                <li><a href="https://leanpub.com/minimumviabletests">Minimum Viable Tests</a></li>
                                <li><a href="https://leanpub.com/grumpy-phpunit">The Grumpy Programmer's PHPUnit Cookbook</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2020 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
