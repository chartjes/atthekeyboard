<!DOCTYPE html>
<html>
    <head>
        <title>Babysteps with xQuery &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <link href="https://vjs.zencdn.net/5.5.3/video-js.css" rel="stylesheet">
        <script src="https://vjs.zencdn.net/ie8/1.1.1/videojs-ie8.min.js"></script>
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/about">About</a></li>
                                <li><a href="/atom.xml">RSS/Atom</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2>Babysteps with xQuery <small>post</small></h2>
            <h3>October 26th, 2007</h3>
        </header>
        <div>
            <p>I know what you're thinking:  "Chris, aren't you supposed to be talking about CakePHP, or PHP, or your ever-changing working conditions?!?".  Alas, enough about my storied working career.  Working <a href="http://www.xmlteam.com">here</a> now means that I'm going to become Mr. "I know how to manipulate XML" in a hurry.  Lucky for me, I can use PHP 5 and have access to SimpleXML to make fooling around with raw XML (is that actually a term?) so much easier.  I remember working with <a href="http://www.sportsticker.com">PA Sportsticker</a> XML feeds and having to write code to parse stuff out in PHP 4.  Compare that to using SimpleXML in PHP 5.  Go ahead, I'll wait while you go and look it up.</p>

<p>
So, for a project I'm working on (no names until it goes beta) I'm having to write and retrieve information from an XML document repository system (<a href='http://www.caucho.com/resin-3.1/'>Resin</a>  + <a href='http://exist.sourceforge.net/'>eXist</a>).  Now, I'm not too bad with database stuff but this system doesn't use SQL.  It uses something called <a href="http://www.w3.org/TR/xquery/">XQuery</a> to retrieve information.  I can pull back XML snippets, whole XML documents, or just extract data from it.  On the storing side, you can simply insert whole XML documents into it and then eXist takes care of indexing etc so you can look for information inside those documents.</p>

<p>
Lucky for me, my company has a subscription to O'Reilly's <a href="http://safari.oreilly.com">Safari</a> system so I grabbed 'XQuery Kick Start' and started reading up on how xQuery works and how I can cheat and only learn what I needed to do for this first task. So, what I had to do was this:
<blockquote>
Give me all games that belong to this league
</blockquote>
So, I had the key for the league, and every document that was a game has the key for the league as an attribute.  Now, if I was doing SQL you'd have something like:
<code>
SELECT * FROM games WHERE league_id = $leagueKey
</code>
and then you iterate through the results like normal.  Let me tell you, xQuery is VERY different.  <a href="http://bin.cakephp.org/saved/24839" target="new">Here's what it looked like</a>.  My apologies for the link to the saved paste but it was looking terrible in preview. :)
</p>

<p>Wow, not too intuitive at first glance, is it.  Anyway, here's what the output looked like:
<code>
2007-10-25 01:00:00AM|Monrovia Madness|Monrovia Madness,
2007-10-26 04:00:00AM|Monrovia Madness|Monrovia Madness,
</code>
Note the extra ',' at the end.  I'll have to figure out how to stop it from doing that so I don't have to do any code workarounds based on the output.  Sorry for the ultra-boring and non-informative test data, but you gotta start somewhere.  Now, the syntax does actually make a little bit of sense to me now that I've had the chance to muddle through from where I started.  I'll keep you posted as I get into some more-than-basic uses of xQuery.
</p>

        </div>
                
                    <nav class="article">
                <ul>
                                            <li>Next: <a class="next" href="/2007/10/31/more-fun-with-capistrano-and-php-applications/" title="More Fun With Capistrano and PHP Applications"><span class="title">More Fun With Capistrano and PHP Applications</span></a></li>
                                                                <li>Previous: <a class="previous" href="/2007/10/23/the-perils-of-telecommuting/" title="The Perils Of Telecommuting"><span class="title">The Perils Of Telecommuting</span></a></li>
                                    </ul>
            </nav>
            </article>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <section>
                            <h3>Find stuff</h3>
                            <script>
                              (function() {
                                var cx = '010269902375244482518:ddxhg1qhod4';
                                var gcse = document.createElement('script');
                                gcse.type = 'text/javascript';
                                gcse.async = true;
                                gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                                    '//www.google.com/cse/cse.js?cx=' + cx;
                                var s = document.getElementsByTagName('script')[0];
                                s.parentNode.insertBefore(gcse, s);
                              })();
                            </script>
                            <gcse:searchbox-only></gcse:searchbox-only>
                        </section>
                        <section>
                            <h3>Contact me</h3>
                            <ul>
                                <li>Email me at chartjes@grumpy-learning.com</li>
                                <li>Find me on Twitter as <a href="https://twitter.com/grmpyprogrammer">@grmpyprogrammer</a></li>
                            </ul>
                        </section>
			<section>
				<h3>Sponsor me</h3>
				<p>If you like the work I do on <a href="https://github.com/opencfp/opencfp/">OpenCFP</a> you can become a
				sponsor via my <a href="https://github.com/sponsors/chartjes">GitHub sponsors</a> page. Your sponsorship
				allows me to spend more time on open source and less time writing books and training material.</p>
			</section>
                        <section>
                            <h3>Books</h3>
                            <ul>
				<li><a href="https://leanpub.com/grumpy-guide">The Grumpy Programmer's Guide To Testing PHP Applications (currently pre-ordering)</a></li>
                                <li><a href="https://leanpub.com/test-driven">Building Test-Driven Developers</a></li>
                                <li><a href="https://leanpub.com/minimumviabletests">Minimum Viable Tests</a></li>
                                <li><a href="https://leanpub.com/grumpy-phpunit">The Grumpy Programmer's PHPUnit Cookbook</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2020 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
