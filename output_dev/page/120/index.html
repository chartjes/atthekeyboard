<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/blog/categories">Categories</a></li>
                                <li><a href="/blog/tags">Tags</a></li>
                                <li><a href="/about">About</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2><a href="/_posts/2009-11-18-using-django-as-an-admin-area-for-a-php-project-part-1.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: Using Django As An Admin Area for a PHP Project, Part 1</h2>

<p>My <a href="http://www.sportso.com">work project</a> needed an admin area for doing things like changing the key for a league, or changing the email address for someone's account.  You know, typical admin stuff.  In the past I had been *gasp* editing SQL by hand via <a href="http://www.pgadmin.org/">pgAdmin</a> (and my favourite trick of creating an SSH tunnel to the server the database is on).  Well, I'd had enough of that.  I also wanted to set things up so when my boss wanted changes done, I could tell him "go do it yourself using this neato-keen admin interface I whipped together".
</p>

<p>
So I got to work creating a <a href="http://www.djangoproject.com">Django</a> project, installed the <a href="http://docs.djangoproject.com/en/dev/ref/contrib/admin/">django-admin</a> application and got to work.
</p>

<p>
Have I mentioned how I *love* code generation these days?  Can I get "hell yeah!" from the lazy programmers out there?  Django comes with this awesome tool that you access via manage.py called <a href="http://docs.djangoproject.com/en/dev/ref/django-admin/#inspectdb">inspectdb</a>.  What it does is introspect the database you configured for your Django application and generates the output for your models.py file.  However, keep in mind the following:
<ul>
<li>You *will* have to fiddle with the order your classes that represent the models appear in the generated code</li>
<li>You *will* have to go in and alter any field definitions where inspectdb was not able to determine the proper field type and instead guessed.</li>
</ul>
</p>

<p>
So, after firing off inspectdb, I then issued a 'python manage.py syncdb' to create all the tables needed for django-admin, created a user for the admin site...and then it got hairy.
</p>

<p>
The documentation for customizing django-admin is good.  And I was able to create just about everything I wanted by actually, you know, READING the documentation.  But I found a problem that I was not able to solve.  I even <a href="http://stackoverflow.com/questions/1758805/problems-with-updating-records-in-django-admin">asked my favourite consultants for help</a> but I could not get it to work the way I *wanted* it to work.  When I told my buddy via IM that it would be easier to whip up this admin in PHP than slog through learning how to do it the Django way, he was not impressed.  He stopped short of saying "you're dead to me now", but I got that vibe.
</p>

<p>
Here's the problem.  I have these two models:<br />
~~~
class Permissions(models.Model):
    league_key = models.CharField(max_length=15) 
    commissioner_id = models.ForeignKey(Accounts, db_column='commissioner_id',
                                        to_field='id')
    status = models.IntegerField()
    key = models.CharField(max_length=50)
    publisher_key = models.CharField(max_length=25)
    publisher_display_name = models.CharField(max_length=50)
    base_league = models.IntegerField()
    share = models.IntegerField()
    default_fixture_key = models.CharField(max_length=50, blank=True)
    
    def __unicode__(self):
        return self.publisher_key + ' / ' + self.league_key
    
    class Meta:
        db_table = u'permissions'
        verbose_name = 'Permissions'
        verbose_name_plural = 'Permissions'

class PermissionsAdmin(admin.ModelAdmin):
    list_display = ('league_key', 'publisher_key', 'commissioner_id', 'status',
                    'share', 'default_fixture_key')
    list_display_links = ('league_key',)
    exclude = ('base_league',)
~~~
</p>

<p>
Now, if you look at the definition in there for the base_league field, you will notice that I gave up and called it an IntegerField.  But in reality, it is pointing to another record in the same Permissions table.  We have a concept in Sportso of a "shared league model" where you can base a league on another league and import all sorts of properties and data from it.  I was hoping that I could do something like this:
~~~
base_league = models.ForeignKey('self', db_column='base_league', to_field='id')
~~~
</p>

<p>
Whenever I did that, I would actually crash Python on my MacBook.  Not a good sign.  If I tried swapping them, I would get an error complaining about violating permissions_pkey, which is the Postgres sequence that was created for the auto-incremented ID for the table.  I did manage to take a look at the SQL it was trying to execute, and it keeps trying to update the 'id' field (which is the primary key) instead of the 'base_league" field.  So I gave up and will continue building out the other parts of the admin.  I just wish I could figure out WHY this self-referencing foreign key setup was not working.
</p>

<p>
If you know what's going on here, let me know via the comments.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/_posts/2009-11-19-the-programming-environment-of-the-future.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: The Programming Environment of the Future</h2>

<p>While working away I was listening (okay, and peeking once in a while) at the live stream from the announcement from Google about <a href="http://www.chromium.org/chromium-os">Chrome OS</a>, an operating system they've been working on.  From what I can tell, it's going to be some stripped-down version of Linux with a window manager that runs one thing:  the Chrome browser.
</p>

<p>
Now, while I think a netbook is great for someone like my <a href="http://teachersatrisk.com">mom</a>, or my daughter, I cannot imagine myself doing any sort of serious programming work on one.  Or can I?</p>

<p>So, first of all it looks like <a href="http://www.vim.org"> is a non-starter.  That means I would likely have to use something like </a><a href="https://mozillalabs.com/bespin/">Mozilla Bespin</a> as my editor.  A quick Google search showed me that you can edit remote files using Bespin, so that is a good thing.  But I would miss doing all the system-level things I've grown accustomed too.  Would make it pretty much impossible to do command line testing of code.
</p>

<p>
And what about all my tools for managing databases?  All the web-based database manipulation tools (like <a href="http://phpmyadmin.net">phpMyAdmin</a> or <a href="http://phppgadmin.sourceforge.net/">phpPgAdmin</a> can probably meet that need.  But then I'm looking at some sort of web-based SSH client to be able to look at things like server configurations or slow query logs.  Again, it's probably doable but is it optimal?
</p>

<p>
Anyway, it's an interesting thought.  Perhaps I should spend some time trying to see if I could actually be productive using the tools I just mentioned above.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/_posts/2009-11-20-cleaning-up-the-dev-environment.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: Cleaning Up The Dev Environment</h2>

<p>Once I got a production push out of the way at work, I set about recreating my PHP development environment.  Currently I was running PHP 5.3.0 with Apache2 and Postgresql 8.4, all installed via MacPorts.  Why the time for a change?  Two reasons.  The first one is my desire to constantly tinker and tweak my environment.  The second reason was to test out some things for future work projects.
</p>

<p>
Those who follow the blog know that I had successfully convinced The Powers That Be at work to use Zend Framework to build out future PHP projects.  I also decided that it would be good to examine if <a href='http://www.zend.com/en/products/server-ce/index'>Zend Server Community Issue</a> is a viable stack for us.  In order to make that decision, I needed to install it and check it out.</p>

<p>
Being the cutting-edge guy that I am, I installed the beta version that comes with PHP 5.3.  I remember that I was having problems getting ZSCE working on Snow Leopard, but those problems seem to have disappeared.  Flawless install, and with about 10 minutes of work tweaking Apache configuration files I had my new PHP stack back.
</p>

<p>
I have to admit that to a jaded "I am sick of personally compiling my stack" person that I am acting like these days, the control panel for Zend Server is nice.  Point and click to add whatever extensions I need.  No more recompiling!  Perfect.  After playing with this, next week I will be installing it on our dev server at work.  MySQL is totally busticated for some reason, so wiping things clean and starting over with the Zend-provided version will be a welcome thing.  It will allow me to actually test some things front-to-back on the dev server.  Apathy towards your program's environment is a killer, so this will help me tighten things up.
</p>

<p>
So, with that out of the way the next step was figuring out what to do about Postgres.  Luckily this part was *really* easy.  I did a pg_dump of the entire database server and went and installed the version of Postgresql for OS-X that <a href="http://www.enterprisedb.com/products/download.do">EnterpriseDB</a> has.  Again, a flawless install and I was up and running in no time.  Created my desired users, and imported my database.  Again, it took about 10 minutes.
</p>

<p>
Other than the required tweak to my php.ini to declare the timezone for the server (I got this humungous warning in CodeIgniter about it) it was smooth sailing.  So now I had Apache 2, PHP 5.3, MySQL and Postgresql, all detached from MacPorts.  Next step was to remove MacPorts itself and I was good to go.
</p>

<p>
MacPorts, it was fun, but I've learned to get by without you.
</p>

        </div>
            </article>
    <nav>
        <a href="/page/119">Newer Posts</a><br />
        <a href="/page/121">Older Posts</a><br />
    </nav>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <h4>Links</h4>
                        <ul class="nav">
                            <li><a href="http://sculpin.io">sculpin.io</a></li>
                            <li><a href="http://twitter.com/getsculpin">@getsculpin</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2014 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
