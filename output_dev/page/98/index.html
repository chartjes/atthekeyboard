<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/blog/categories">Categories</a></li>
                                <li><a href="/blog/tags">Tags</a></li>
                                <li><a href="/about">About</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2><a href="/_posts/2008-11-19-come-heckle-me-at-the-2009-php-quebec-conference.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: Come Heckle Me At The 2009 PHP Quebec Conference!</h2>

<p>
I just got word that my proposal to give a version of my "Deployment Is Not A 4-Letter Word" talk has been accepted for <a href="http://conf.phpquebec.com">2009 PHP Quebec Conference</a>.  It's actually within driving distance for me (5 hours) or maybe I can chill and take the train.  Either way, I'll be there from March 4 to March 6, 2009.
</p>

<p>
It looks like a pretty great conference lineup, so I suggest you check it out and consider coming to Montreal in March.  It's a great city and I've always enjoyed myself every time I've gone.  It will also be nice to see some people I've met before and always more fun to make new friends.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/_posts/2008-11-27-converting-legacy-apps-to-cakephp-part-1.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: Converting Legacy Apps to CakePHP, Part 1</h2>

<p>In order to make some extra money, I do side projects from time to time.  In my rapidly dwidling spare time I have been working on a project to convert an existing site for a legal services company over to PHP.  I'm *this* close to being done, so I thought I'd share what I went through to get to where I am right now.</p>

<p>
The existing code is typical of what I call the pre-framework era.  It had grown organically, much like many applications do.  When I initially did the code review (contact me if you're interested in having me do a code review of your application) I noticed lots of stuff that needed fixing.  No escaping of database input or filter of output.  Plaintext passwords in the database.  Total mixing of business logic with presentation logic.  To make things a little more difficult, SOME of the application was done properly in terms of separating business logic from presentation logic through a system of HTML templates that would have parts of it filled in via token replacement.  Not great, but not the end of the world.
</p>

<p>
I could also tell that multiple people had worked on it.  How?  Inconsistency in coding standards.  That and the comments strewn throughout it indicating who had done what.  Did I also mention that no version control was used on the project at all, so lots of copies of files like user_search.php.old, user_search.php.old.2.  You get the idea.  The best news of all was that the application DID work and met the objectives of the business.  Never lose sight of that when contemplating a legacy rewrite.
</p>

<p>
So after giving the code review I was asked to do the rewrite.  The client realized that they had some serious maintenance issues on their hands and were in the process of creating a new look-and-feel for the site.  Being the framework guy that I am, I indicated that porting the code over to a framework would be the best way to reduce maintenance issues going forward.  Why?  More and more developers are starting to work with frameworks, and gaining the discipline that comes from using the Model-View-Controller design pattern.  Also it would be a lot easier to start creating new templates for the site since only the presentation will be changing, not the data itself.
</p>

<p>
After considering using this project as a learning tool for Django, I settled on CakePHP.  Time was sort of important here and I thought that a paying job was not one where I should be fooling around learning Django.  Plus I had no confidence that the host they were using would be able to accomodate my desire for a Python + Django + mod_wsgi setup. 
</p>

<p>
In part two I will talk about the first thing I did once I started:  tackle the database structure.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/_posts/2008-11-28-handling-multiple-environments-in-your-php-application.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post
title: Handling Multiple Environments In Your PHP Application
author: Chris Hartjes</p>

<h2>date: 2008-11-28</h2>

<p>In anticipation of my <a href="http://conf.phpquebec.com/en/session#deployment_is_not_a_4_letter_word">talk at PHP Quebec 2009</a> I've been going over my slides and thinking about what I'm going to update for it.  One little nugget I'd thought I'd share is one way of handling having multiple environments your code must run in.
</p>

<p>
For a work application, I have *three* environments that the code must run in:  'dev' (which is my laptop), 'staging' (which is where I look for the infamous "bug does not exist in production" type of errors), and 'production'.  For all these environments, there are different web services that they need to speak to so I tried to think of an easy way to handle this.  I have a configuration file that is used, so it seemed to me that this would be a logical place to do the *check* for what environment we are in.  But *how* to define where we are?  That turned out to be easy.
</p>

<p>
If you are using Apache, you have the ability to define server variables that can be read in using $_SERVER.  I'm sure you can do the same thing with other web servers, but this example is Apache-specific.  So, I figured the best way to handle this problem was to define a server variable and have a unique value for each environment.  Then, I added in code that checks the contents of that server variable and reacted accordingly.  Here's an example:
</p>

<p>
~~~
<?php
// In Apache, add SetEnv APP_ENV "<unique environment value>" somewhere in your http.conf file
// e.g. SetEnv APP_ENV 'dev'

switch ($_SERVER['APP_ENV']) {
    case 'dev':
        $config['webservice'] = 'http://admin@localhost:8008';
        $config['putfeed'] = 'http://dev.domain.com:8080/put/sml';
        break;
    case 'production':
        $config['webservice'] = 'http://admin|password@ws.domain.com:8080';
        $config['putfeed'] = 'http://in.domain.com/put/sml';
        break;
}
?>
~~~
</p>

<p>(NOTE:  <a href="http://snook.ca/jonathan/">Jonathan Snook</a> asked me to add an example on how to configure SetEnv)</p>

<p>
Then, in your Apache httpd.conf file you add the SetEnv directive.  Here's a snippet of how I did it for a work project:
~~~
<virtualhost *:80> 
     ServerName local.sportso.com 
     DocumentRoot /Users/chartjes/Sites/sportso.com 
     SetEnv SPORTSO_ENV "dev" 
  
     <directory /Users/chartjes/Sites/sportso.com> 
         Options Indexes FollowSymLinks MultiViews 
         AllowOverride None 
         Order allow,deny 
         Allow from all 
          
         RewriteEngine on 
         RewriteCond %{QUERY_STRING} ^last-accessed=(.*)$ 
         RewriteRule ^(.*)$ $1/last-accessed/%1? 
         RewriteRule ^$ /index.php [L] 
         RewriteRule ^/$ /index.php [L] 
         RewriteCond $1 !^(index\.php|images|styles|js|robots\.txt) 
         RewriteRule ^(.*)$ /index.php/$1 [L] 
     </directory> 
      
     LogLevel warn 
     ErrorLog /opt/local/apache2/logs/sportso.com-error.log 
     CustomLog /opt/local/apache2/logs/sportso.com-access.log combined 
</virtualhost> 
~~~
</p>

<p>
Hope that helps out any other developers struggling to think of an elegant way to determine what environment you are in.  As opposed to the lazy method of checking a production version of the config file into your version control system and then simply not checking back in the hacked-up dev version of it. ;)
</p>

        </div>
            </article>
    <nav>
        <a href="/page/97">Newer Posts</a><br />
        <a href="/page/99">Older Posts</a><br />
    </nav>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <h4>Links</h4>
                        <ul class="nav">
                            <li><a href="http://sculpin.io">sculpin.io</a></li>
                            <li><a href="http://twitter.com/getsculpin">@getsculpin</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2014 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
