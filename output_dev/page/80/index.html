<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; @TheKeyboard &mdash; The ramblings of a grumpy programmer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="@TheKeyboard activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">@TheKeyboard</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/blog/categories">Categories</a></li>
                                <li><a href="/blog/tags">Tags</a></li>
                                <li><a href="/about">About</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2><a href="/_posts/2008-02-18-cooking-up-some-cake.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: Cooking Up Some Cake</h2>

<p>
Of all the people in the <a href="http://www.cakephp.org">CakePHP</a> community that I have come across, none suffers from a lack of respect more than John David Anderson, more commonly known as _psychic_ on IRC.  Why do I say this?  John heads the CakePHP documentation project, a thankless task that seems only to exist so unimaginative people can complain that there is no documentation for CakePHP.  If I had a dollar for every person on the CakePHP mailing list who seems to either not understand how to use Google or how to look at someone else's PHP code to figure out how something works, I could retire and blog full time.
</p>

<p>
But I digress.  With a ton of help from Andy Dawson (AD7Six) the documentation for CakePHP 1.2 has moved forward immensely with the unveiling of the <a href="http://book.cakephp.org">CakePHP Cookbook</a>.  It's a combination of manual and wiki, where people can flesh out the manual and make comments on the methods in there.  I have been quite harsh on people who have called for a CakePHP wiki in the past, because they tend to be a mess.  This project is just different enough that I cannot stop recommending people to use the cookbook when searching for answers to their CakePHP problems.  In fact, if you can contribute by moving entries over from the <a href="http://tempdocs.cakephp.org">temporary documentation</a> to the cookbook, _psychic_ will have one less thing to do.
</p>

<p>
From now on, whenever I find a solution to something in CakePHP I will not only post it here on my blog (because, after all, I am still an egomaniac) I will also create an entry in the Cookbook if it's appropriate.  Lucky for you, contributions are anonymous so you won't be able to tell what I've put in there.  My first contribution has been to get my documentation on the Auth component in there (although my simple user registration stuff isn't in there), and <a href="http://www.3hndesigns.com/">Baz</a> added his stuff he's been doing with Auth as well.
</p>

<p>
So, no more excuses about lack of documentation!  Anyone who registers and account can create entries in the manual, and everyone who complains about on the mailing list will be told to go look at the cookbook and contribute changes and comments to it.
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/_posts/2008-02-27-whats-in-chris-brain-february-2008-edition.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post</p>

<h2>title: "What's In Chris' Brain: February 2008 Edition"</h2>

<p>
I'm sitting in the Orlando airport at this ungodly hour waiting for a flight to Memphis as part of an Orlando -> Memphis -> Toronto trip back from my two days at the Newspaper Association of America conference.  I was there with my <a href='http://www.xmlteam.com'>employer</a> to help start promoting the <a href="http://www.sportso.com">project I've been working on</a>.  It was an interesting show, and I had a great time in the booth hanging out and talking with Ken Zajac from <a href="http://sportsnetwork.com">The Sports Network</a> and Digger Turnbull from <a href="http://fantasysports.ca">Fantasy Sports Services</a>.  It was fun huddling around Digger's computer listening to the latest moves during the NHL's trading deadline day.
</p>

<p>Anyway, enough geeking out about my sports fetish.  Work took up a lot of my time this last 2 weeks getting ready for the demo, so my posting has suffered a bit.  Here are some of the things I've been thinking about.:
<ul>
<li>more and more messages about using the CakePHP Auth component on the mailing list</li>
<li>I will be doing some Python work later this week on a utility to rip through some of our archived XML documents at work and do some search-and-replace ninja work.</li>
<li>Investing in using <a href="http://jquery.com">jQuery</a> for work has made for some super-quick integration of some new features.  It took me under half-an-hour from the first search in google to get an autocomplete plugin for jQuery working.  Now *that* is rapid development</li>
<li>Despite my best efforts I can't get vim setup and working the way I want.  Sorry Kevin, TextMate is just the best one for me, and Komodo when I need to break out the Xdebug guns</li>
<li>I'm going to put together a post (and contribute the same info to the <a href="http://book.cakephp.org">CakePHP Cookbook</a>) on my experiences with custom pagination usage with Cake, since I had to hack something together for recent changes I've been working on for the <a href="http://www.ibl.org">IBL website</a></li>
</ul>
</p>

<p>
Anyway, enough talking.  It's way too early to do this sort of nonsense (can't believe I have coherent thoughts at 5:30AM) and it's close to boarding time.  See you on the other side...
</p>

        </div>
            </article>
    <article>
        <header>
            <h2><a href="/_posts/2008-03-04-custom-cakephp-12-pagination-queries.markdown"></a></h2>
        </header>
        <div>
            <hr />

<p>layout: post
title: Custom CakePHP 1.2 Pagination Queries
date: 2008-03-04</p>

<h2>author: Chris Hartjes</h2>

<p>
(Note: I will be cross-posting a version of this to <a href='http://book.cakephp.org'>the CakePHP Cookbook</a> within a day or two).
</p>

<p>
As amazing as the built-in CakePHP pagination helper is, sometimes you have to create your own custom queries for data you wish to paginate.  For <a href='http://www.ibl.org'>the simulation baseball league site</a> I wanted to be create an admin area where I could paginate through the series instead of individual games.  It took some digging around with google, but I found some info in a thread (thanks to <a href='http://www.3hndesigns.com/'>Baz</a> for contributing that tidbit to the thread) on how to do just that.
</p>

<p>
Okay, so it turns out that the paginate() method that is used to generate the data that you (oddly enough) paginate through takes the same arguments as Model::findAll().  So, if you want to use your own query, you simply create a 'paginate' method for your model.  In my case, I needed a query that would group things together (because a 'series' is simply a collection of all games between two teams in a particular week).  The query stuff I did is ugly because there currently is no support 'group by' in CakePHP (although that would be a very interesting project to tackle).  So, here's what I did:
</p>

<pre><code>/**
 * Custom paginate method
 */
function paginate($conditions, $fields, $order, $limit, $page = 1, $recursive = null) {
    $conditions[] ="1 = 1 GROUP BY week, away_team_id, home_team_id";
    $recursive = -1;
    $fields = array('week', 'away_team_id', 'home_team_id');

    $params = array(
          'conditions' =&gt; $conditions,
          'recursive' =&gt; $recursive,
          'fields' =&gt; $fields,
          'order' =&gt; $order,
          'limit' =&gt; $limit,
          'page' =&gt; $page
     );

     return $this-&gt;find('all', $params);
}
</code></pre>

<p>
So, that's the first part of the custom query stuff taken care off.  Next, I needed to be able to properly count the number of 'series' so that the numbers (you know, that stuff that says 'page 7 of 23') come out properly.  Again, you can override the paginateCount() method if you need to.  It uses the same parameters as Model::findCount().  Now, the custom query I'm using below is Postgres-specific, so YMMV:
</p>

<pre><code>/**
 * Custom paginateCount method
 */
function paginateCount($conditions = null, $recursive = 0) {
    $sql = "SELECT DISTINCT ON(week, home_team_id, away_team_id) week, home_team_id, away_team_id FROM games";
    $this-&gt;recursive = $recursive;
    $results = $this-&gt;query($sql);

    return count($results);
}
</code></pre>

<p>
So there you have it.  Hope this helps out anyone who's been trying to figure out how to use custom queries with their pagination.
</p>

        </div>
            </article>
    <nav>
        <a href="/page/79">Newer Posts</a><br />
        <a href="/page/81">Older Posts</a><br />
    </nav>
                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>@TheKeyboard <small>The ramblings of a grumpy programmer</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <h4>Links</h4>
                        <ul class="nav">
                            <li><a href="http://sculpin.io">sculpin.io</a></li>
                            <li><a href="http://twitter.com/getsculpin">@getsculpin</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2014 @TheKeyboard
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
